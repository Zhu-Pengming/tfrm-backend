<view class="skus-container">
  <view class="header-section">
    <view class="header-top">
      <view class="header-title">äº§å“èµ„æºåº“</view>
      <view class="header-actions">
        <view class="view-mode-toggle">
          <view 
            class="mode-btn {{viewMode === 'grid' ? 'active' : ''}}"
            bindtap="switchViewMode"
            data-mode="grid"
          >
            <text class="mode-icon">â–¦</text>
          </view>
          <view 
            class="mode-btn {{viewMode === 'list' ? 'active' : ''}}"
            bindtap="switchViewMode"
            data-mode="list"
          >
            <text class="mode-icon">â˜°</text>
          </view>
        </view>
        <view class="search-bar">
          <input 
            class="search-input" 
            placeholder="æœç´¢ SKU..."
            value="{{keyword}}"
            bindinput="onKeywordInput"
            bindconfirm="handleSearch"
          />
          <text class="search-icon">ğŸ”</text>
        </view>
        <view class="batch-btn" bindtap="toggleBatchMode">
          <text class="batch-icon">{{isBatchMode ? 'âœ“' : 'âš™'}}</text>
        </view>
      </view>
    </view>

    <view wx:if="{{isBatchMode}}" class="batch-controls">
      <view class="batch-info">
        <text class="batch-count">å·²é€‰ {{selectedSkus.length}} ä¸ª</text>
      </view>
      <view class="batch-actions">
        <input 
          class="margin-input" 
          type="digit"
          placeholder="æ¯›åˆ©ç‡%"
          value="{{batchMargin}}"
          bindinput="onMarginInput"
        />
        <button class="batch-apply-btn" bindtap="applyBatchMargin">åº”ç”¨è°ƒä»·</button>
        <button class="batch-cancel-btn" bindtap="cancelBatchMode">å–æ¶ˆ</button>
      </view>
    </view>

    <view class="library-tabs">
      <view class="tab-item {{isPrivate ? 'active' : ''}}" bindtap="toggleLibrary">
        <text>ç§æœ‰åº“</text>
      </view>
      <view class="tab-item {{!isPrivate ? 'active' : ''}}" bindtap="toggleLibrary">
        <text>å…¬å…±æ± </text>
      </view>
    </view>
  </view>

  <view class="category-filter">
    <scroll-view scroll-x class="category-scroll">
      <view 
        wx:for="{{categories}}" 
        wx:key="value" 
        class="category-item {{selectedCategoryIndex === index ? 'active' : ''}}"
        bindtap="onCategoryChange"
        data-index="{{index}}"
      >
        <view class="category-icon">{{item.icon}}</view>
        <text class="category-label">{{item.label}}</text>
      </view>
    </scroll-view>
  </view>

  <view class="basket-float" wx:if="{{basketCount > 0}}" bindtap="handleViewBasket">
    <text class="basket-icon">ğŸ›’</text>
    <text class="basket-count">{{basketCount}}</text>
  </view>

  <view wx:if="{{loading}}" class="loading-state">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <view wx:elif="{{skuList.length === 0}}" class="empty-state">
    <view class="empty-icon">ğŸ“¦</view>
    <text class="empty-title">èµ„æºåº“ç©ºç©ºå¦‚ä¹Ÿ</text>
    <text class="empty-text">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„äº§å“</text>
  </view>

  <view wx:else class="sku-list {{viewMode}}">
    <view 
      wx:for="{{skuList}}" 
      wx:key="id" 
      class="sku-card {{isBatchMode ? 'batch-mode' : ''}}"
    >
      <view wx:if="{{isBatchMode}}" class="batch-checkbox" catchtap="toggleSkuSelection" data-sku-id="{{item.id}}">
        <view class="checkbox {{selectedSkus.indexOf(item.id) > -1 ? 'checked' : ''}}">
          <text wx:if="{{selectedSkus.indexOf(item.id) > -1}}" class="check-icon">âœ“</text>
        </view>
      </view>

      <view class="card-header">
        <view class="sku-type-badge type-{{item.sku_type}}">
          {{typeLabels[item.sku_type] || item.sku_type}}
        </view>
        <view class="header-badges">
          <view wx:if="{{item.is_from_cooperation}}" class="source-badge cooperation">
            ğŸ¤ åˆä½œ
          </view>
          <view wx:elif="{{item.is_published}}" class="source-badge published">
            ğŸŒ å·²å‘å¸ƒ
          </view>
          <view wx:else class="source-badge private">
            ğŸ”’ ç§æœ‰
          </view>
          <view wx:if="{{item.needsAttention}}" class="attention-badge">âš ï¸</view>
        </view>
      </view>

      <view class="card-body" bindtap="handleViewDetail" data-sku-id="{{item.id}}">
        <text class="sku-name">{{item.sku_name}}</text>
        
        <view class="sku-location">
          <text class="location-icon">ğŸ“</text>
          <text class="location-text {{!item.destination_city && !item.destination_country ? 'missing' : ''}}">{{item.destination_city || item.destination_country || 'å¾…è¡¥å……ç›®çš„åœ°'}}</text>
        </view>

        <view class="sku-pricing">
          <view class="price-item">
            <text class="price-label">æˆæœ¬</text>
            <text class="price-value cost">Â¥{{item.costPrice || 0}}</text>
          </view>
          <view class="price-item" catchtap="handlePriceEdit" data-sku-id="{{item.id}}" data-current-price="{{item.salesPrice}}">
            <text class="price-label">é”€å”® {{editingPriceId === item.id ? '' : 'âœï¸'}}</text>
            <text wx:if="{{editingPriceId !== item.id}}" class="price-value sales">Â¥{{item.salesPrice || 0}}</text>
            <input 
              wx:else
              class="price-edit-input"
              type="digit"
              value="{{item.salesPrice}}"
              focus="{{true}}"
              bindblur="handlePriceBlur"
              bindconfirm="handlePriceConfirm"
              data-sku-id="{{item.id}}"
            />
          </view>
          <view class="price-item">
            <text class="price-label">æ¯›åˆ©ç‡</text>
            <text class="price-value margin {{item.profitMargin < 10 ? 'low' : 'good'}}">{{item.profitMargin}}%</text>
          </view>
        </view>
      </view>

      <view class="card-footer">
        <button 
          class="btn-add-primary" 
          catchtap="handleAddToBasket"
          data-sku="{{item}}"
        >
          åŠ å…¥æŠ¥ä»·
        </button>
        <button 
          class="btn-more" 
          catchtap="handleMoreActions"
          data-sku="{{item}}"
        >
          â‹¯
        </button>
      </view>
    </view>
  </view>
</view>
