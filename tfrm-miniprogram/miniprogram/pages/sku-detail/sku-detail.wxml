<view class="detail-container">
  <view wx:if="{{loading}}" class="loading-state">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <scroll-view wx:else scroll-y class="detail-scroll">
    <!-- é¡¶éƒ¨å›¾ç‰‡é¢„è§ˆ -->
    <view class="hero-image">
      <image class="hero-img" src="https://images.unsplash.com/photo-1542314831-068cd1dbfeeb?auto=format&fit=crop&q=80&w=800" mode="aspectFill"></image>
      <view class="hero-overlay"></view>
      <view class="hero-content">
        <view class="hero-badge">
          <text class="badge-text">{{typeLabels[sku.sku_type]}}</text>
        </view>
        <text class="hero-title">{{sku.sku_name}}</text>
        <view class="hero-location">
          <text class="location-icon">ğŸ“</text>
          <text class="location-text">{{sku.destination_city || sku.destination_country || 'å¾…è¡¥å……ç›®çš„åœ°'}}</text>
        </view>
      </view>
      <view wx:if="{{needsAttention}}" class="attention-badge">
        <text class="attention-icon">âš ï¸</text>
        <text class="attention-text">ä¿¡æ¯å¾…è¡¥å……</text>
      </view>
    </view>

    <!-- ä»·æ ¼ä¿¡æ¯å¡ç‰‡ -->
    <view class="price-card">
      <view class="price-row">
        <view class="price-item">
          <text class="price-label">æˆæœ¬ä»·</text>
          <view class="price-edit-wrapper" catchtap="handleEditPrice" data-field="cost">
            <text class="price-value cost">Â¥{{costPrice || 0}}</text>
            <text class="edit-hint">âœï¸</text>
          </view>
        </view>
        <view class="price-divider"></view>
        <view class="price-item">
          <text class="price-label">é”€å”®ä»·</text>
          <view class="price-edit-wrapper" catchtap="handleEditPrice" data-field="sales">
            <text class="price-value sales">Â¥{{salesPrice || 0}}</text>
            <text class="edit-hint">âœï¸</text>
          </view>
        </view>
        <view class="price-divider"></view>
        <view class="price-item">
          <text class="price-label">æ¯›åˆ©ç‡</text>
          <text class="price-value margin {{profitMargin < 10 ? 'low' : 'good'}}">{{profitMargin}}%</text>
        </view>
      </view>
    </view>

    <!-- äº§å“æè¿° -->
    <view class="description-section" wx:if="{{sku.description}}">
      <text class="description-text">{{sku.description}}</text>
    </view>

    <!-- ä½“éªŒäº®ç‚¹ -->
    <view class="highlights-section" wx:if="{{sku.highlights && sku.highlights.length > 0}}">
      <text class="section-title">âœ¨ ä½“éªŒäº®ç‚¹</text>
      <view class="highlights-list">
        <view wx:for="{{sku.highlights}}" wx:key="*this" class="highlight-item">
          <text class="highlight-icon">âœ“</text>
          <text class="highlight-text">{{item}}</text>
        </view>
      </view>
    </view>

    <!-- è´¹ç”¨åŒ…å«/ä¸å« -->
    <view class="inclusions-section" wx:if="{{sku.inclusions || sku.exclusions}}">
      <view class="inclusion-card" wx:if="{{sku.inclusions && sku.inclusions.length > 0}}">
        <text class="inclusion-title">âœ“ è´¹ç”¨åŒ…å«</text>
        <view class="inclusion-list">
          <view wx:for="{{sku.inclusions}}" wx:key="*this" class="inclusion-item">
            <text class="inclusion-bullet">â€¢</text>
            <text class="inclusion-text">{{item}}</text>
          </view>
        </view>
      </view>
      <view class="exclusion-card" wx:if="{{sku.exclusions && sku.exclusions.length > 0}}">
        <text class="exclusion-title">âœ— è´¹ç”¨ä¸å«</text>
        <view class="exclusion-list">
          <view wx:for="{{sku.exclusions}}" wx:key="*this" class="exclusion-item">
            <text class="exclusion-bullet">â€¢</text>
            <text class="exclusion-text">{{item}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æœåŠ¡å‚æ•° -->
    <view class="specs-section" wx:if="{{attrsList.length > 0}}">
      <text class="section-title">ğŸ“‹ æœåŠ¡å‚æ•°</text>
      <view class="specs-grid">
        <view wx:for="{{attrsList}}" wx:key="key" class="spec-item" catchtap="handleEditField" data-field="{{item.key}}" data-label="{{item.label}}" data-value="{{item.value}}">
          <text class="spec-icon">{{item.icon || 'ğŸ“Œ'}}</text>
          <view class="spec-content">
            <text class="spec-label">{{item.label}}</text>
            <text class="spec-value">{{item.value}}</text>
          </view>
          <text class="spec-edit">âœï¸</text>
        </view>
      </view>
    </view>

    <!-- é€€æ¬¾è§„åˆ™ -->
    <view class="policy-section" wx:if="{{sku.cancellation_policy || sku.cancel_policy}}">
      <text class="section-title">ğŸ”„ é€€æ¬¾è§„åˆ™</text>
      <view class="policy-card">
        <text class="policy-text">{{sku.cancellation_policy || sku.cancel_policy}}</text>
      </view>
    </view>

    <!-- æ ‡ç­¾ -->
    <view class="tags-section" wx:if="{{sku.tags && sku.tags.length > 0}}">
      <text class="section-title">ğŸ·ï¸ æ ‡ç­¾</text>
      <view class="tags-list">
        <text wx:for="{{sku.tags}}" wx:key="*this" class="tag">{{item}}</text>
      </view>
    </view>

    <!-- ä¾›åº”å•†ä¿¡æ¯ -->
    <view class="supplier-section" wx:if="{{sku.supplier_name}}">
      <text class="section-title">ğŸ¢ ä¾›åº”å•†</text>
      <view class="supplier-card">
        <text class="supplier-name">{{sku.supplier_name}}</text>
      </view>
    </view>

    <!-- SKU ID -->
    <view class="meta-section">
      <text class="meta-label">SKU ID</text>
      <text class="meta-value">{{sku.id}}</text>
    </view>

    <!-- åº•éƒ¨å ä½ -->
    <view class="bottom-spacer"></view>
  </scroll-view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view wx:if="{{!loading}}" class="action-bar">
    <button class="btn-toggle" bindtap="handleTogglePrivacy">
      {{sku.owner_type === 'private' ? 'ğŸ”’ è½¬ä¸ºå…¬å¼€' : 'ğŸŒ è½¬ä¸ºç§æœ‰'}}
    </button>
    <button class="btn-delete" bindtap="handleDelete">
      ğŸ—‘ï¸ åˆ é™¤
    </button>
    <button class="btn-primary" bindtap="handleAddToBasket">
      åŠ å…¥æŠ¥ä»·
    </button>
  </view>
</view>
